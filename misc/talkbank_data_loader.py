# Databricks notebook source
# MAGIC %fs mkdirs /tmp/talkbank/

# COMMAND ----------

from urllib.request import urlopen

links = ['0638.wav',
'4065.wav',
'4074.wav',
'4077.wav',
'4092.wav',
'4093.wav',
'4104.wav',
'4112.wav',
'4145.wav',
'4156.wav',
'4157.wav',
'4170.wav',
'4183.wav',
'4184.wav',
'4234.wav',
'4245.wav',
'4247.wav',
'4248.wav',
'4289.wav',
'4290.wav',
'4310.wav',
'4315.wav',
'4316.wav',
'4325.wav',
'4335.wav',
'4365.wav',
'4371.wav',
'4390.wav',
'4404.wav',
'4415.wav',
'4431.wav',
'4432.wav',
'4459.wav',
'4484.wav',
'4485.wav',
'4490.wav',
'4507.wav',
'4520.wav',
'4521.wav',
'4522.wav',
'4537.wav',
'4543.wav',
'4544.wav',
'4547.wav',
'4556.wav',
'4560.wav',
'4564.wav',
'4569.wav',
'4571.wav',
'4574.wav',
'4576.wav',
'4577.wav',
'4580.wav',
'4595.wav',
'4601.wav',
'4604.wav',
'4610.wav',
'4612.wav',
'4616.wav',
'4622.wav',
'4623.wav',
'4624.wav',
'4628.wav',
'4629.wav',
'4660.wav',
'4665.wav',
'4666.wav',
'4673.wav',
'4677.wav',
'4683.wav',
'4686.wav',
'4689.wav',
'4694.wav',
'4702.wav',
'4705.wav',
'4721.wav',
'4726.wav',
'4753.wav',
'4776.wav',
'4790.wav',
'4792.wav',
'4801.wav',
'4802.wav',
'4807.wav',
'4808.wav',
'4822.wav',
'4824.wav',
'4829.wav',
'4838.wav',
'4844.wav',
'4852.wav',
'4854.wav',
'4861.wav',
'4875.wav',
'4886.wav',
'4887.wav',
'4902.wav',
'4908.wav',
'4910.wav',
'4913.wav',
'4926.wav',
'4927.wav',
'4938.wav',
'4941.wav',
'4966.wav',
'4967.wav',
'4968.wav',
'5011.wav',
'5017.wav',
'5020.wav',
'5023.wav',
'5046.wav',
'5166.wav',
'5208.wav',
'5242.wav',
'5254.wav',
'5273.wav',
'5278.wav',
'5352.wav',
'5373.wav',
'5388.wav',
'5495.wav',
'5532.wav',
'5551.wav',
'5573.wav',
'5648.wav',
'5700.wav',
'5712.wav',
'5713.wav',
'5736.wav',
'5777.wav',
'5788.wav',
'5866.wav',
'5872.wav',
'5888.wav',
'5907.wav',
'5931.wav',
'6033.wav',
'6045.wav',
'6047.wav',
'6067.wav',
'6071.wav',
'6079.wav',
'6100.wav',
'6107.wav',
'6130.wav',
'6161.wav',
'6165.wav',
'6179.wav',
'6183.wav',
'6189.wav',
'6217.wav',
'6252.wav',
'6265.wav',
'6267.wav',
'6274.wav',
'6282.wav',
'6298.wav',
'6313.wav',
'6314.wav',
'6348.wav',
'6408.wav',
'6447.wav',
'6456.wav',
'6467.wav',
'6474.wav',
'6479.wav',
'6489.wav',
'6521.wav',
'6625.wav',
'6658.wav',
'6785.wav',
'6825.wav',
'6861.wav',
'6880.wav',
'6912.wav']

i = 1
for link in links:
  print(link, i)
  i = i + 1
  with urllib.request.urlopen(f"https://media.talkbank.org/ca/CallHome/eng/0wav/{link}") as response:
      body = response.read()

  with open(f"/tmp/talkbank/{link}", mode="wb") as html_file:
      html_file.write(body)

# COMMAND ----------

# MAGIC %fs ls file:/tmp/talkbank/

# COMMAND ----------

# MAGIC %fs cp -r file:/tmp/talkbank/ dbfs:/FileStore/Users/bachar.wehbi@databricks.com/talkbank/

# COMMAND ----------

# MAGIC %fs ls dbfs:/FileStore/Users/bachar.wehbi@databricks.com/talkbank/

# COMMAND ----------


